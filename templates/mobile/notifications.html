{% extends "mobile/base_mobile.html" %}

{% block title %}الإشعارات{% endblock %}

{% block content %}
<!-- Mobile Header -->
<header class="mobile-header">
    <button class="back-button" onclick="history.back()">
        <i class="fas fa-chevron-left"></i>
    </button>
    <h1 class="header-title">الإشعارات</h1>
    <div style="width: 36px"></div>
</header>

<div class="main-content">
    {% if notifications %}
        <div class="notifications-wrapper">
            {% for notification in notifications %}
                <div class="notification-item {% if not notification.is_read %}unread{% endif %}" 
                     data-id="{{ notification.id }}">
                    <div class="notification-icon-wrapper {{ notification.notification_type }}">
                        {% if notification.notification_type == 'success' %}
                            <i class="fas fa-check-circle"></i>
                        {% elif notification.notification_type == 'warning' %}
                            <i class="fas fa-exclamation-triangle"></i>
                        {% elif notification.notification_type == 'danger' %}
                            <i class="fas fa-times-circle"></i>
                        {% else %}
                            <i class="fas fa-info-circle"></i>
                        {% endif %}
                    </div>
                    <div class="notification-content">
                        <h6 class="notification-title">{{ notification.title }}</h6>
                        <p class="notification-text">{{ notification.content }}</p>
                        <span class="notification-time">{{ notification.created_at.strftime('%Y-%m-%d %H:%M') }}</span>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="empty-state">
            <div class="empty-state-icon">
                <i class="fas fa-bell-slash"></i>
            </div>
            <h3>لا توجد إشعارات</h3>
            <p>ستظهر هنا الإشعارات المتعلقة بحسابك والخدمات التي تستخدمها</p>
        </div>
    {% endif %}
</div>

<!-- Bottom Navigation -->
<nav class="mobile-bottom-nav">
    <div class="nav-wrapper">
        <a href="{{ url_for('mobile_index') }}" class="nav-item">
            <i class="fas fa-home"></i>
            <span>الرئيسية</span>
        </a>
        <a href="{{ url_for('services') }}" class="nav-item">
            <i class="fas fa-hands-helping"></i>
            <span>الخدمات</span>
        </a>
        <a href="{{ url_for('mobile_notifications') }}" class="nav-item active">
            <i class="fas fa-bell"></i>
            <span>الإشعارات</span>
        </a>
        <a href="{{ url_for('mobile_dashboard') }}" class="nav-item">
            <i class="fas fa-user"></i>
            <span>حسابي</span>
        </a>
    </div>
</nav>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const notificationItems = document.querySelectorAll('.notification-item');
    
    notificationItems.forEach(item => {
        item.addEventListener('click', function() {
            if (this.classList.contains('unread')) {
                const notificationId = this.dataset.id;
                fetch(`/notifications/mark-read/${notificationId}`)
                .then(response => {
                    if (response.ok) {
                        this.classList.remove('unread');
                    }
                });
            }
        });
    });

    // إضافة وظيفة الوضع الليلي
    const darkModeToggle = document.getElementById('darkModeToggle');
    
    // تحقق من حالة الوضع الليلي المحفوظة
    if (localStorage.getItem('darkMode') === 'true') {
        document.documentElement.setAttribute('data-theme', 'dark');
        darkModeToggle.checked = true;
    }
    
    darkModeToggle.addEventListener('change', function() {
        if (this.checked) {
            document.documentElement.setAttribute('data-theme', 'dark');
            localStorage.setItem('darkMode', 'true');
        } else {
            document.documentElement.setAttribute('data-theme', 'light');
            localStorage.setItem('darkMode', 'false');
        }
    });
});
</script>
{% endblock %}
